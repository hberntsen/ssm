/* 	Runner.java	Title:			Simple Stack Machine Runner	Author:			atze	Description:	*/package nl.uu.cs.ssmui;import javax.swing.*;import java.io.* ;import java.util.* ;public class AssemblyParser {    private StreamTokenizer tokens ;    private int tok ;        protected AssemblyParser( Reader input )    {        tokens = new StreamTokenizer( input ) ;        tokens.resetSyntax() ;        tokens.wordChars( '0', '9' ) ;        tokens.wordChars( 'a', 'z' ) ;        tokens.wordChars( 'A', 'Z' ) ;        tokens.wordChars( 0xA0, 0xF0 ) ;        tokens.wordChars( '_', '_' ) ;        tokens.wordChars( '-', '-' ) ;        tokens.whitespaceChars( 0x00, 0x20 ) ;        tokens.commentChar( ';' ) ;        tokens.quoteChar( '"' ) ;        tokens.eolIsSignificant( true ) ;        tokens.slashSlashComments( true ) ;        next() ;    }        private void next()    {        try        {            if ( ! isAtEOF() )                tok = tokens.nextToken() ;        }        catch ( IOException ex )        {            tok = tokens.TT_EOF ;        }    }        public boolean isAtEOF()    {        return tok == tokens.TT_EOF ;    }        private boolean isAtEOL()    {        return tok == tokens.TT_EOL || isAtEOF() ;    }        protected AssemblyParseResult parse1Line( AssemblyParseResult prevAPR )    {        int lineNr = tokens.lineno() ;        String label = null ;        String msg = null ;        Vector<String> instrNArgs = new Vector<String>() ;                if ( ! isAtEOL() )        {            if ( tok == tokens.TT_WORD )            {                String s = tokens.sval ;                next() ;                if ( tok == ':' )                {                    label = s ;                    next() ;                }                else                {                    instrNArgs.addElement( s ) ;                }                                while( ! isAtEOL() )                {                    if ( tok == tokens.TT_WORD || tok == '"' )                    {                        instrNArgs.addElement( tokens.sval ) ;                    }                    else if ( tok == tokens.TT_NUMBER )                    {                        msg = "did not expect number " + tokens.nval ;                    }                    else                    {                        msg = "did not expect `" + (char)tok + "'" ;                    }                    next() ;                }            }            else            {                msg = "expected label or instruction" ;            }        }        next() ;        if ( prevAPR == null )            return new AssemblyParseResult( lineNr, msg, label, instrNArgs ) ;        else            return prevAPR.addInfo( lineNr, msg, label, instrNArgs ) ;    }    }